Question 1 =========

SELECT 
  SUBSTR(firstname, 1, 1) || '. ' || surname || ' lives in the state of ' ||
  CASE 
    WHEN state = 'FL' THEN 'Florida'
    WHEN state = 'CA' THEN 'California'
    ELSE 'Unknown'
  END AS "Referred customers"
FROM customers
WHERE referredby IS NOT NULL
ORDER BY surname;

Question 2 =========

SELECT 
  UPPER(c.firstname || ' ' || c.surname) || ' has referred ' || 
  COUNT(r.customerid) || ' customers to the book club' AS "Referee Statistics"
FROM customers c
JOIN customers r ON c.customerid = r.referredby
GROUP BY c.firstname, c.surname;


Question 3 =========

SELECT 
  COUNT(*) AS "Number of Books",
  UPPER(author) AS "Author",
  'R' || TO_CHAR(SUM(price), '9990.99') AS "Total Book Cost"
FROM books
WHERE UPPER(author) = 'LISA WHITE'
GROUP BY author;


Question 4 ===========
4.1)
CREATE TABLE TB_CUSTOMER (
  customer_id NUMBER(7) PRIMARY KEY,
  name VARCHAR2(50) NOT NULL,
  phone VARCHAR2(25) UNIQUE,
  address VARCHAR2(400),
  credit_rating VARCHAR2(9)
);

CREATE TABLE TB_ORD (
  id NUMBER(7) PRIMARY KEY,
  customer_id NUMBER(7),
  date_ordered DATE,
  total NUMBER(11, 2)
);

4.2)
SELECT table_name FROM user_tables WHERE table_name IN ('TB_CUSTOMER', 'TB_ORD');

4.3) 
ALTER TABLE TB_CUSTOMER MODIFY credit_rating VARCHAR2(10);

4.4)
CREATE SEQUENCE TB_CUSTOMER_seq 
START WITH 2165001 
INCREMENT BY 1 
MAXVALUE 99999;

4.5)
INSERT INTO TB_CUSTOMER (customer_id, name, phone, address, credit_rating)
VALUES (TB_CUSTOMER_seq.NEXTVAL, 'Mike', '082 654 7842', '1547 Aubrey Road Witbank', 'Poor');

INSERT INTO TB_CUSTOMER (customer_id, name, phone, address, credit_rating)
VALUES (TB_CUSTOMER_seq.NEXTVAL, 'Thomas', '082 654 7844', '1955 Valley Street Polokwane', 'Good');

4.6)
ALTER TABLE TB_ORD 
ADD CONSTRAINT fk_customer 
FOREIGN KEY (customer_id) 
REFERENCES TB_CUSTOMER(customer_id);

4.7)
INSERT INTO TB_ORD (id, customer_id, date_ordered, total) 
VALUES (&id, &customer_id, &date_ordered, &total);

4.8)
DELETE FROM TB_ORD;
DELETE FROM TB_CUSTOMER;

4.9)
DROP TABLE TB_ORD;
DROP TABLE TB_CUSTOMER;

4.10)
DROP SEQUENCE TB_CUSTOMER_seq;

